<template name='dashboard'>
<div class="container-fluid">
  <div class="row">
    <div id="fullbuildingcolumn" class="col-xs-4 well">
      {{> generalbuildingcolumn}}
    </div>
    <div id="hvacbuildingcolumn" class="col-xs-4 well">
      {{> hvacbuildingcolumn}}
    </div>
    <div id="lightingbuildingcolumn" class="col-xs-4 well">
      {{> lightingbuildingcolumn}}
    </div>
  </div>
</div>
</template>

<!-- Render each power meter in the building-wide general column -->
<template name="generalbuildingcolumn">
<h2>General</h2>
{{#each powermeterAll}}
{{> power_meter_widget}}
{{/each}}
</template>

<template name="hvacbuildingcolumn">
<h2>Building HVAC</h2>
{{#each HVACAll}}
<div class="infobox dark well">
  {{> hvac_zone_widget}}
</div>
{{/each}}
</template>

<template name="lightingbuildingcolumn">
<h2>Building Lighting</h2>
{{#each LightingAll}}
<div class="infobox dark well">
{{> light_zone_widget}}
</div>
{{/each}}
</template>

<template name="hvac_zone_widget">
  <h3 class="centertext">Zone: {{zone}}</h3>
  <div class="row">
    <div class="col-xs-6">
      <p><b>Cool Setpoint:</b> {{getValue 'temp_cool'}}</p>
      <p><b>Temp:</b> {{getValue 'temp'}}</p>
      <p><b>Heat Setpoint:</b> {{getValue 'temp_heat'}}</p>
      <a class="button button-small" href="{{pathFor 'zone_detail' zonetype='hvac' zone=zone }}">Detail</a>
    </div>
    <div class="col-xs-6">
      {{#each sensors}}
        <div class="sensorbox">
          <p><b>Room:</b> {{room}}</p>
          <p><b>Temp:</b> {{getValue 'temp'}}</p>
          <p><b>Humidity:</b> {{getValue 'humidity'}}</p>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="light_zone_widget">
  <h3 class="centertext">Zone: {{zone}}</h3>
  <div class="row">
    <div class="col-xs-6">
      {{#each groups}}
      <div class="row">
        <h4 class="centertext">Group: {{group}}</h4>
        <div class="col-xs-6">
          <p><b>On:</b> {{getValue 'on'}}</p>
          <p><b>Brightness:</b> {{getValue 'bri'}}</p>
          <p><b>Hue:</b> {{getValue 'hue'}}</p>
        </div>
        <div class="col-xs-6">
          {{#each sensors}}
          <div class="sensorbox">
            <p><b>Room:</b> {{room}} </p>
            <p><b>Illumination:</b> {{getValue 'illumination'}} </p>
          </div>
          {{/each}}
        </div>
      </div>
      {{/each}}
    </div>
    <div class="col-xs-6">
      {{#each internals}}
        <div class="sensorbox">
          <p><b>Room:</b> {{path}} </p>
        </div>
      {{/each}}
    </div>
  </div>
  <a class="button button-small" href="{{pathFor 'zone_detail' zonetype='lighting' zone=zone }}">Detail</a>
</template>

<template name="power_meter_widget">
<div class="infobox dark well">
  <p><b>Demand:</b> {{getValue 'demand'}}</p>
</div>
</template>

<template name="zone_detail">
{{#if is_hvac type}}
  {{#each points}}
    {{> thermostat}}
  {{/each}}
{{else}}{{#if is_lighting type}}
  {{#each points}}
    {{> lightinggroup}}
  {{/each}}
{{/if}}{{/if}}
</template>

<template name="thermostat">
 <h2>Zone: {{zone}}</h2>
 <h3>{{path}}</h3>
 <div class='table-responsive'>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Path</th>
        <th>Value</th>
        <th>Type</th>
      </tr>
    </thead>
    <tbody>
      {{#if has 'temp'}}
      <tr id="{{uuid 'temp'}}">
        {{> point timeseries.temp}}
      </tr>
      {{/if}}

      {{#if has 'humidity'}}
      <tr id="{{uuid 'humidity'}}">
        {{> point timeseries.humidity}}
      </tr>
      {{/if}}

      {{#if has 'hvac_state'}}
      <tr id="{{uuid 'hvac_state'}}">
        {{> point timeseries.hvac_state}}
      </tr>
      {{/if}}

      {{#if has 'temp_heat'}}
      <tr id="{{uuid 'temp_heat'}}">
        {{> point timeseries.temp_heat}}
      </tr>
      {{/if}}

      {{#if has 'temp_cool'}}
      <tr id="{{uuid 'temp_cool'}}">
        {{> point timeseries.temp_cool}}
      </tr>
      {{/if}}

      {{#if has 'hold'}}
      <tr id="{{uuid 'hold'}}">
        {{> point timeseries.hold}}
      </tr>
      {{/if}}

      {{#if has 'override'}}
      <tr id="{{uuid 'override'}}">
        {{> point timeseries.override}}
      </tr>
      {{/if}}

      {{#if has 'hvac_mode'}}
      <tr id="{{uuid 'hvac_mode'}}">
        {{> point timeseries.hvac_mode}}
      </tr>
      {{/if}}

      {{#if has 'fan_mode'}}
      <tr id="{{uuid 'fan_mode'}}">
        {{> point timeseries.fan_mode}}
      </tr>
      {{/if}}

    </tbody>
  </table>
</div>

</template>

<template name="point">
</template>

<template name="lightinggroup">
 <h2>Zone: {{zone}}</h2>
 <h3>{{path}}</h3>
 <div class='table-responsive'>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Path</th>
        <th>Value</th>
        <th>Type</th>
      </tr>
    </thead>
    <tbody>
      {{#if has 'on'}}
      <tr id="{{uuid 'on'}}">
        {{> point timeseries.on }}
      </tr>
      {{/if}}

      {{#if has 'bri'}}
      <tr id="{{uuid 'bri'}}">
        {{> point timeseries.bri }}
      </tr>
      {{/if}}

      {{#if has 'hue'}}
      <tr id="{{uuid 'hue'}}">
        {{> point timeseries.hue }}
      </tr>
      {{/if}}

    </tbody>
  </table>
</div>

</template>
